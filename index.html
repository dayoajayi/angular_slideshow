<!DOCTYPE html>
<html ng-app>
<head>
    <title>Dallas GeekNight Angular Slideshow</title>
    <style>
    a.right {
        float: right;
    }
    table {
        min-width: 100%;
    }
    tr {
        min-width: 100%;
    }
    img {
        min-width: 100%;
        max-width: 100%;
        height: auto;
    }
    </style>
    <script src="js/jquery-mobile-angular-adapter-standalone-1.2.1-SNAPSHOT.js" type="text/javascript"></script>
    <link href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.css" rel="stylesheet" type="text/css">
</head>
<body ng-controller="SlideShowCtrl">
    <table ng-style="showStyle">
        <tr id="1" ng-show="currentSlide == 1 && !touchScreen">
            <td>
                <img ngm-swipeleft="nav(2)" ng-style="slideStyle" src="angular_slide_1.svg"/>
            </td>
        </tr>
        <tr ng-show="currentSlide == 1">
            <td>
                <a ng-click="nav(2)" class="right">next</a>
            </td>
        </tr>
        <tr id="2" ng-show="currentSlide == 2">
            <td>
                <img ngm-swiperight="nav(1)" ngm-swipeleft="nav(3)" ng-style="slideStyle" src="angular_slide_2.svg"/>
            </td>
        </tr>
        <tr ng-show="currentSlide == 2 && !touchScreen" style="display:none;">
            <td>
                <a ng-click="nav(1)" class="left">back</a>
                <a ng-click="nav(3)" class="right">next</a>
            </td>
        </tr>
        <tr id="3" ng-show="currentSlide == 3">
            <td>
                <img ngm-swiperight="nav(2)" ngm-swipeleft="nav(4)" ng-style="slideStyle" src="angular_slide_3.svg"/>
            </td>
        </tr>    
        <tr ng-show="currentSlide == 3 && !touchScreen" style="display:none;">
            <td>
                <a ng-click="nav(2)" class="left">back</a>
                <a ng-click="nav(4)" class="right">next</a>
            </td>
        </tr>
        <tr id="4" ng-show="currentSlide == 4">
            <td>
                <img ngm-swiperight="nav(3)" ng-style="slideStyle" src="angular_slide_4.svg"/>
            </td>
        </tr>
        <tr ng-show="currentSlide == 4 && !touchScreen" style="display:none;">
            <td>
                <a ng-click="nav(3)" class="left">back</a>
            </td>    
        </tr>    
    </table>
    <script>
        function SlideShowCtrl($scope, $window) {
            
            $scope.currentSlide = 1;
            if (window.location.hash != '') {
                $scope.currentSlide = window.location.hash.substring(1);
            }
            $scope.height = 0;
            $scope.width = 0;
            $scope.showStyle = {};
            $scope.slideStyle = {};
            
            $scope.touchScreen = false;
            
            var el = document.createElement('div');
            el.setAttribute('ongesturestart', 'return;');
            if (typeof el.ongesturestart === "function") {
                   $scope.touchScreen = true;
            }

            $scope.nav = function(toSlide) {
              $scope.currentSlide = toSlide;
              window.location.hash = "#" + toSlide;
            }
            
            $scope.updateHeight = function () {
                $scope.height = $window.innerHeight;
            }

            $scope.slideAreaAdjustment = function () {
                if ($scope.height < $scope.width) {
                    console.log($scope.height + ", " + $scope.width);
                    var showHeight = $scope.height + "px";
                    var slideHeight = Math.round($scope.height * 0.90) + "px";
                    $scope.showStyle = {minHeight: showHeight, maxHeight: showHeight};
                    $scope.slideStyle = {maxHeight: slideHeight};
                } else {
                    $scope.showStyle = {};
                    $scope.slideStyle = {};
                }
            }

            $scope.updateHeight();
            $scope.slideAreaAdjustment();

            $window.onresize = function () {
                $scope.updateHeight();
                $scope.slideAreaAdjustment();
                $scope.$apply();
            }
        }
    </script>
</body>
</html>
